<nb-card>
    <nb-card-header class="boldFont">
        Role
    </nb-card-header>

    <nb-card-body>
        <div class="two-columns">
            <div class="field-margin">
                <label class="label regularFont">CGIAR Entity</label>
                <nb-form-field>
                    <nb-select 
                        #cgiarEntityInput 
                        class="regularFont" 
                        [placeholder]="defaultValue"
                        [formControl]="cgiarEntityControl" 
                        [(selected)]="cgiarEntity" 
                        (selectedChange)="loadRoleList()"
                    >
                        <nb-option>{{defaultValue}}</nb-option>
                        <nb-option *ngFor="let entity of entityList$ | async" [value]="entity">{{entity.acronym}}</nb-option>
                    </nb-select>
                </nb-form-field>
                <!--div *ngIf="submitted && form['cgiarEntity'].errors" class="messageContainer status-danger">
                    <div *ngIf="form['cgiarEntity'].errors['required']" class="hiddenMessage">Is CGIAR is required.</div>
                </div-->
            </div>
            <div class="field-margin">
                <label class="label regularFont">Role</label>
                <nb-form-field>
                    <nb-select 
                        #roleInput 
                        [placeholder]="defaultValue"
                        class="regularFont" 
                        [formControl]="roleControl" 
                        [(selected)]="role"
                        (selectedChange)="loadPermissionList()"
                    >
                        <nb-option>{{defaultValue}}</nb-option>
                        <nb-option *ngFor="let role of roleList$ | async" [value]="role">{{role.acronym}} - {{role.description}}</nb-option>
                    </nb-select>
                </nb-form-field>
                <!--div *ngIf="submitted && form['role'].errors" class="messageContainer status-danger">
                    <div *ngIf="form['role'].errors['required']" class="hiddenMessage">Is CGIAR is required.</div>
                </div-->
            </div>
        </div>
    </nb-card-body>
</nb-card>
<nb-card>
    <nb-card-header class="boldFont">
        Permissions
    </nb-card-header>

    <nb-card-body>
        <nb-form-field>
            <nb-tag-list (tagRemove)="onPermissionRemove($event)">
                <nb-tag *ngFor="let tag of selectedPermissions" [text]="tag.name" removable></nb-tag>
                <input type="text" nbTagInput (tagAdd)="onPermissionAddByString($event.value)" [nbAutocomplete]="autocomplete" fullWidth>
            </nb-tag-list>
      
            <nb-icon nbSuffix icon="search" pack="eva"></nb-icon>
        </nb-form-field>
      
        <nb-autocomplete #autocomplete (selectedChange)="onPermissionAdd($event)">
            <nb-option *ngFor="let currentPermission of currentPermissionList" [value]="currentPermission">{{ currentPermission.name }}</nb-option>
        </nb-autocomplete>
    </nb-card-body>
    <nb-card-footer class="example-items-rows">
        <button nbButton status="success" class="boldFont" (click)="save()">Update Role</button>
    </nb-card-footer>
</nb-card>
<nb-alert status="success" [style]="roleUpdated ? 'display: flex' : 'display: none'">Role successfully updated</nb-alert>
